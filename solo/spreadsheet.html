<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FORM REFLEKSI SPREADSHEET</title>
<style>
:root{
Â  --bg: #f5f8ff;Â 
Â  --accent: #007bff;Â 
Â  --muted: #334e68;Â 
Â  --card: #ffffff;Â 
Â  --input: #f7f9fc;Â 
Â  --nav-bg: #eaf1fa;Â 
Â  --shadow-light: rgba(0, 0, 0, 0.05);
Â  --shadow-medium: rgba(0, 0, 0, 0.1);
}
*{box-sizing:border-box; transition: all 0.2s ease-out;}
body{font-family:"Segoe UI",system-ui,Roboto,Arial,sans-serif;margin:0;background:var(--bg);color:var(--muted);font-size:13px}Â 

/* --- KOREKSI HEADER UNTUK IKON HOME --- */
header{
Â  position:fixed;
Â  top:0;
Â  left:0;
Â  right:0;
Â  background:linear-gradient(90deg, #007bff, #0056b3);
Â  color:#fff;
Â  padding:10px 8px;
Â  z-index:220;Â 
Â  box-shadow: 0 2px 5px var(--shadow-medium);
Â  display: flex;
Â  justify-content: space-between;
Â  align-items: center;
}
header h1{
Â  margin:0;
Â  font-weight:700;
Â  font-size:16px;
Â  text-align:center;
Â  flex-grow: 1;
}
.home-icon-link {
Â  Â  color: #fff;
Â  Â  text-decoration: none;
Â  Â  font-size: 18px;
Â  Â  padding: 0 5px;
Â  Â  line-height: 1;
}
.home-icon-link:hover {
Â  Â  color: #ffd700;Â 
}
/* --- END KOREKSI HEADER --- */

.identity-bar{position:fixed;top:40px; left:0;right:0;background:var(--nav-bg);padding:8px 10px;z-index:215;border-bottom:1px solid #dcdfe4; box-shadow: 0 1px 3px var(--shadow-light);}Â 
.identity-inner{max-width:980px;margin:0 auto;display:flex;flex-direction:column;gap:6px}Â 
.identity-row{display:flex;gap:8px;flex-wrap:wrap}Â 
.identity-field{flex:1}
label{display:block;font-size:14px;font-weight:700;color:var(--muted);margin-bottom:2px}Â 
input[type="text"], select{width:100%;padding:6px 8px;border-radius:6px;border:1px solid #c9d6e4;background:var(--input);font-size:13px; color:var(--muted);}Â 
input[type="text"]:focus, select:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);}

/* CSS untuk Nama Peserta Didik (Label) */
.label-nama {
Â  Â  font-size: 14px;
Â  Â  font-weight: 700;Â 
Â  Â  color: var(--muted);Â 
}

/* --- FIXED NAVIGATION CSS --- */
.question-nav-fixed-bar {
Â  Â  position: fixed;
Â  Â  top: 175px;
Â  Â  left: 0;
Â  Â  right: 0;
Â  Â  background: #fff;Â 
Â  Â  padding: 5px 0;
Â  Â  z-index: 200;Â 
Â  Â  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
Â  Â  border-bottom: 1px solid #e0e8f0;
}
.fixed-nav-inner {
Â  Â  max-width: 980px;
Â  Â  margin: 0 auto;
Â  Â  text-align: center;
Â  Â  padding: 0 10px;
Â  Â  display: flex;
Â  Â  flex-wrap: wrap;Â 
Â  Â  justify-content: center;
Â  Â  gap: 4px;Â 
}
.fixed-nav-inner button{
Â  Â  display:inline-block;
Â  Â  margin:0;Â 
Â  Â  padding:4px 6px;Â 
Â  Â  border-radius:4px;
Â  Â  border:none;
Â  Â  background:#d8e8ff;
Â  Â  color:#0056b3;
Â  Â  font-size:11px;
Â  Â  cursor:pointer;
Â  Â  min-width:28px;Â 
Â  Â  font-weight: 600;Â 
Â  Â  box-shadow: 0 1px 2px var(--shadow-light);
Â  Â  flex-shrink: 0;Â 
}
.fixed-nav-inner button:hover { background: #c6daff; }
.fixed-nav-inner button.current-q { background: var(--accent)!important; color: #fff!important; box-shadow: 0 2px 4px rgba(0, 123, 255, 0.3);}
/* --- END FIXED NAVIGATION CSS --- */


/* PADDING MAIN DITINGKATKAN agar tidak tertutup FIXED NAV BAR */
.main{max-width:980px;margin:0 auto;padding:220px 10px 80px;}

.question-card{background:var(--card);border-left:4px solid var(--accent);padding:10px; border-radius:8px;margin-bottom:15px; box-shadow:0 4px 8px var(--shadow-light); position: relative;}
.q-text{font-size:16px;margin:0 0 6px 0;font-weight:700;color:var(--accent);}Â 
.options{display:flex;flex-direction:column;gap:4px}Â 
.opt{display:flex;align-items:flex-start;gap:8px;padding:6px 8px; border-radius:6px;background:var(--input);border:1px solid #e0e8f0;font-size:17px; cursor: pointer; position: relative;}Â 
.opt:hover{background: #eaf1fa; border-color: #c9d6e4;}

/* Emboss/Selected effect for option */
.opt input[type="radio"]:checked + span {font-weight: 700;color: #0056b3;}
.opt input[type="radio"]{display: none;}
.opt.checked-option {
Â  Â  background: #e8f0fe;
Â  Â  border: 2px solid var(--accent);
Â  Â  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);Â 
}
.opt span{display:block;font-weight:400;color:var(--muted);font-size:13px;line-height:1.3}Â 

.fixed-send{position:fixed;left:0;right:0;bottom:0;background:linear-gradient(90deg, #007bff, #0056b3);padding:8px 10px; z-index:230;box-shadow:0 -2px 8px rgba(0,0,0,0.1);}
.fixed-inner{max-width:980px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;gap:10px}
.footer-note { color: #fff; font-size: 11px; font-weight: 400; margin: 0;}Â 
.btn-send{background:#fff;color:var(--accent);padding:8px 12px; border-radius:6px;border:none;font-weight:700;cursor:pointer; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);}
.btn-send:hover{background:#f0f0f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);}
.btn-send:active{transform: translateY(1px);}

/* --- NEW SUCCESS OVERLAY CSS --- */
#success-overlay {
Â  Â  position: fixed;
Â  Â  top: 0;
Â  Â  left: 0;
Â  Â  width: 100%;
Â  Â  height: 100%;
Â  Â  background: rgba(0, 0, 0, 0.6);
Â  Â  display: flex;
Â  Â  justify-content: center;
Â  Â  align-items: center;
Â  Â  z-index: 9999;
Â  Â  opacity: 0;
Â  Â  pointer-events: none;
Â  Â  transition: opacity 0.3s ease-in-out;
}
#success-overlay.show {
Â  Â  opacity: 1;
Â  Â  pointer-events: auto;
}
#success-box {
Â  Â  background: var(--card);
Â  Â  padding: 30px 40px;
Â  Â  border-radius: 10px;
Â  Â  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
Â  Â  text-align: center;
Â  Â  transform: scale(0.8);
Â  Â  transition: transform 0.3s ease-in-out;
}
#success-overlay.show #success-box {
Â  Â  transform: scale(1);
}
#success-box h2 {
Â  Â  color: var(--accent);
Â  Â  margin-top: 0;
Â  Â  font-size: 24px;
}
#success-box p {
Â  Â  color: var(--muted);
Â  Â  margin-bottom: 20px;
}
#success-box button {
Â  Â  background: #28a745;
Â  Â  color: white;
Â  Â  padding: 10px 20px;
Â  Â  border: none;
Â  Â  border-radius: 6px;
Â  Â  cursor: pointer;
Â  Â  font-weight: 700;
}
.checkmark {
Â  Â  font-size: 50px;
Â  Â  color: #28a745;Â 
Â  Â  line-height: 1;
Â  Â  margin-bottom: 10px;
Â  Â  display: block;
}
/* --- END NEW SUCCESS OVERLAY CSS --- */

@media (max-width:480px){
Â  .main{padding-top:250px;padding-bottom:70px}
Â  .identity-bar{top:44px;}
Â  .question-nav-fixed-bar { top: 170px; }
Â  .fixed-nav-inner button{padding:3px 5px; min-width:24px; font-size:13px;}
}
</style>
</head>
<body>

<div id="success-overlay">
Â  <div id="success-box">
Â  Â  <span class="checkmark">âœ”</span>
Â  Â  <h2>Refleksi Berhasil Terkirim!</h2>
Â  Â  <p>Terima kasih atas partisipasi Anda. Data refleksi telah tersimpan dengan aman.</p>
Â  Â  <button onclick="closeSuccessOverlay()">Tutup</button>
Â  </div>
</div>
<header>
Â  <a href="https://andes-web.github.io/mpsmobile/" target="_blank" class="home-icon-link" title="Beranda">
Â  Â  ğŸ 
Â  </a>
Â Â 
Â  <h1>FORM REFLEKSI SPREADSHEET</h1>
Â Â 
Â  <div style="width: 30px;"></div>
</header>

<div class="identity-bar">
Â  <div class="identity-inner">
Â  Â  <div class="identity-field">
Â  Â  Â  <label for="nama" class="label-nama">Nama Peserta Didik</label> <input id="nama" name="nama" type="text" placeholder="Tuliskan nama lengkap Anda" required>
Â  Â  </div>
Â  Â  <div class="identity-row">
Â  Â  Â  <div class="identity-field">
Â  Â  Â  Â  <label for="kelas">Kelas</label>
Â  Â  Â  Â  <select id="kelas" name="kelas" required>
Â  Â  Â  Â  Â  <option value="">Pilih Kelas</option>
Â  Â  Â  Â  Â  <option value="KELAS X AKL1">KELAS X AKL1</option>
Â  Â  Â  Â  Â  <option value="KELAS X AKL2">KELAS X AKL2</option>
Â  Â  Â  Â  Â  <option value="KELAS X AKL3">KELAS X AKL3</option>
Â  Â  Â  Â  Â  <option value="KELAS X AKL4">KELAS X AKL4</option>
Â  Â  Â  Â  </select>
Â  Â  Â  </div>
Â  Â  Â  <div class="identity-field">
Â  Â  Â  Â  <label for="sesi">Sesi</label>
Â  Â  Â  Â  <select id="sesi" name="sesi" required>
Â  Â  Â  Â  Â  <option value="">Pilih Sesi</option>
Â  Â  Â  Â  Â  <option value="As Learning">As Learning</option>
Â  Â  Â  Â  Â  <option value="For Learning">For Learning</option>
Â  Â  Â  Â  Â  <option value="Of Learning">Of Learning</option>
Â  Â  Â  Â  </select>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
</div>

<div class="question-nav-fixed-bar">
Â  <div class="fixed-nav-inner" id="fixedNavButtons">
Â  Â  </div>
</div>

<main class="main">
Â  <form id="refleksiForm" method="POST" action="https://script.google.com/macros/s/AKfycbyUb3JGhRAe0Z4nfmCOuSsXVuaonNHuKqA0EPLNdfJLQfeXowmmW18imKZoiV640Whp0Q/exec">
Â  Â  <div id="questions"></div>
Â  </form>
</main>

<div class="fixed-send">
Â  <div class="fixed-inner">
Â  Â  <p class="footer-note">@2025 Andes</p>
Â  Â  <button id="btnNext" class="btn-send">KIRIM REFLEKSI</button>
Â  </div>
</div>

<script>
const questions = [
Â "Bagaimana Anda memahami peran spreadsheet dalam pengelolaan uang jajan atau kas sekolah?",
Â "Bagaimana Anda menuliskan operasi aritmatika sederhana (+, -, *, /) di spreadsheet untuk menghitung total?",
Â "Bagaimana Anda memanfaatkan fungsi SUM untuk menghitung total pemasukan atau pengeluaran?",
Â "Bagaimana Anda menggunakan AVERAGE untuk mengetahui rata-rata pengeluaran mingguan?",
Â "Bagaimana Anda memakai COUNT dan COUNTA untuk menghitung entri angka dan teks di tabel?",
Â "Bagaimana Anda menggunakan COUNTIF dan COUNTBLANK untuk memeriksa data tertentu dan sel kosong?",
Â "Bagaimana Anda menerapkan SUMIF untuk menjumlahkan transaksi berdasarkan kategori tertentu?",
Â "Bagaimana Anda menggunakan fungsi IF/AND/OR untuk memberi status otomatis (mis: Lunas/Tidak)?",
Â "Bagaimana Anda memakai VLOOKUP atau HLOOKUP untuk mengambil data dari tabel lain?",
Â "Bagaimana Anda menggabungkan beberapa fungsi agar laporan keuangan lebih otomatis dan akurat?",
Â "Bagaimana Anda membaca hasil perhitungan untuk mengambil keputusan sederhana pada pengeluaran?",
Â "Bagaimana Anda menggunakan spreadsheet untuk merencanakan anggaran kegiatan kecil atau proyek kelas?",
Â "Bagaimana Anda mencari dan memperbaiki kesalahan rumus yang menyebabkan hasil tidak sesuai?",
Â "Bagaimana Anda menilai perkembangan kemampuan spreadsheet Anda sejak awal pembelajaran?",
Â "Bagaimana rencana Anda agar kemampuan spreadsheet semakin meningkat setelah fase ini?"
];

const options = [
Â ["Saya belum mencoba atau memahami penggunaannya sama sekali.",
Â  "Saya tahu fungsi dasar spreadsheet namun belum menghubungkannya ke keuangan.",
Â  "Saya mampu mencatat dan menghitung transaksi sederhana dalam tabel pribadi.",
Â  "Saya bisa membuat tabel kas sederhana dan menjelaskan fungsinya ke teman.",
Â  "Saya mampu merancang format laporan kas yang rapi dan terpakai di praktik nyata."],
Â ["Saya belum tahu cara menulis operasi aritmatika di sel spreadsheet.",
Â  "Saya pernah menulis rumus pada satu sel namun sering menghasilkan error.",
Â  "Saya menulis operasi aritmatika untuk beberapa perhitungan sederhana dengan benar.",
Â  "Saya menggabungkan beberapa operasi untuk menghitung total dan subtotal dengan benar.",
Â  "Saya membuat rumus aritmatika kompleks untuk otomatisasi perhitungan berulang."]
];

const qContainer=document.getElementById('questions');
let current=0;

function createQuestions(){
Â  for(let i=0;i<questions.length;i++){
Â  Â  const card=document.createElement('div');
Â  Â  card.className='question-card';
Â  Â  card.id='q'+i;
Â  Â  card.style.display='none';

Â  Â  const q=document.createElement('p');
Â  Â  q.className='q-text';
Â  Â  q.textContent=(i+1)+'. '+questions[i];
Â  Â  card.appendChild(q);
Â  Â Â 
Â  Â  const optWrap=document.createElement('div');
Â  Â  optWrap.className='options';
Â  Â  (options[i%2]).forEach((op,j)=>{
Â  Â  Â  const label=document.createElement('label');
Â  Â  Â  label.className='opt';
Â  Â  Â  const input=document.createElement('input');
Â  Â  Â  input.type='radio';input.name='q'+i;input.value=j+1;
Â  Â  Â Â 
Â  Â  Â  input.addEventListener('change', function() {
Â  Â  Â  Â  Â  label.parentElement.querySelectorAll('.opt').forEach(l => l.classList.remove('checked-option'));
Â  Â  Â  Â  Â  if (this.checked) {
Â  Â  Â  Â  Â  Â  Â  label.classList.add('checked-option');
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  updateNav();
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  const span=document.createElement('span');
Â  Â  Â  span.textContent=op;
Â  Â  Â Â 
Â  Â  Â  label.appendChild(input);
Â  Â  Â  label.appendChild(span);
Â  Â  Â  optWrap.appendChild(label);
Â  Â  });
Â  Â  card.appendChild(optWrap);

Â  Â  qContainer.appendChild(card);
Â  }
Â  generateFixedNav();
}

function generateFixedNav() {
Â  Â  const navContainer = document.getElementById('fixedNavButtons');
Â  Â  for(let n=0; n < questions.length; n++) {
Â  Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  Â  btn.textContent = n + 1;
Â  Â  Â  Â  btn.type = 'button';
Â  Â  Â  Â  btn.onclick = () => show(n);
Â  Â  Â  Â  navContainer.appendChild(btn);
Â  Â  }
}

createQuestions();
show(0);

function show(i){
Â  document.querySelectorAll('.question-card').forEach(c=>c.style.display='none');
Â  const currentCard = document.getElementById('q'+i);
Â  if (currentCard) {
Â  Â  Â  currentCard.style.display='block';
Â  Â  Â  current=i;
Â  Â  Â  updateNav();
Â  Â  Â  window.scrollTo({ top: 0, behavior: 'smooth' });
Â  }
}

function updateNav(){
Â  const btns = document.getElementById('fixedNavButtons').querySelectorAll('button');
Â Â 
Â  btns.forEach((b,i)=>{
Â  Â  const radio = document.querySelector('input[name="q'+i+'"]:checked');
Â  Â  const answered=!!radio;
Â  Â Â 
Â  Â  if (i === current) {
Â  Â  Â  Â  b.classList.add('current-q');
Â  Â  } else {
Â  Â  Â  Â  b.classList.remove('current-q');
Â  Â  }

Â  Â  if (answered) {
Â  Â  Â  Â  b.style.background = 'var(--accent)';
Â  Â  Â  Â  b.style.color = '#fff';
Â  Â  Â  Â  if (radio && document.querySelector('label.opt input[name="q'+i+'"][value="'+radio.value+'"]')) {
Â  Â  Â  Â  Â  Â  document.querySelector('label.opt input[name="q'+i+'"][value="'+radio.value+'"]').parentElement.classList.add('checked-option');
Â  Â  Â  Â  }
Â  Â  } else if (i !== current) {Â 
Â  Â  Â  Â  b.style.background = '#d8e8ff';
Â  Â  Â  Â  b.style.color = '#0056b3';
Â  Â  Â  Â  document.querySelectorAll('label.opt input[name="q'+i+'"]').forEach(r => r.parentElement.classList.remove('checked-option'));
Â  Â  }
Â  });
}
// FUNGSI RESET LENGKAP
function completeFormReset() {
Â  Â  const form = document.getElementById('refleksiForm');
Â  Â Â 
Â  Â  // 1. Reset input form
Â  Â  form.reset();Â 
Â  Â Â 
Â  Â  // 2. Reset input identitas di luar form (jika ada)
Â  Â  document.getElementById('nama').value = '';
Â  Â  document.getElementById('kelas').selectedIndex = 0;
Â  Â  document.getElementById('sesi').selectedIndex = 0;

Â  Â  // 3. Reset tampilan opsi (hapus emboss)
Â  Â  document.querySelectorAll('.opt').forEach(l => l.classList.remove('checked-option'));
Â  Â Â 
Â  Â  // 4. Kembali ke pertanyaan pertama
Â  Â  show(0);
Â  Â Â 
Â  Â  // 5. Reset tampilan navigasi tombol
Â  Â  updateNav();Â 
}

// FUNGSI NOTIFIKASI
function showSuccessOverlay() {
Â  Â  document.getElementById('success-overlay').classList.add('show');
}

window.closeSuccessOverlay = function() {
Â  Â  document.getElementById('success-overlay').classList.remove('show');
};

document.addEventListener('DOMContentLoaded', () => {
Â  Â  updateNav();
});

document.getElementById('btnNext').onclick=()=>{
Â  if(current<questions.length-1){
Â  Â  show(current+1);
Â  } else {
Â  Â  let allAnswered = true;
Â  Â  for(let i=0; i<questions.length; i++) {
Â  Â  Â  Â  if (!document.querySelector('input[name="q'+i+'"]:checked')) {
Â  Â  Â  Â  Â  Â  alert('Harap jawab semua pertanyaan sebelum mengirim. Pertanyaan ' + (i+1) + ' belum dijawab.');
Â  Â  Â  Â  Â  Â  show(i);
Â  Â  Â  Â  Â  Â  allAnswered = false;
Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  }
Â  Â  }
Â  Â  if (allAnswered) {
Â  Â  Â  Â  sendData();
Â  Â  }
Â  }
};

function sendData(){
Â  const nama=document.getElementById('nama').value.trim();
Â  const kelas=document.getElementById('kelas').value;
Â  const sesi=document.getElementById('sesi').value;
Â  if(!nama||!kelas||!sesi){
Â  Â  Â  alert('Lengkapi identitas terlebih dahulu');
Â  Â  Â  document.getElementById('nama').focus();
Â  Â  Â  return;
Â  }

Â  const form=document.getElementById('refleksiForm');
Â  const fd=new FormData(form);
Â  fd.append('nama', nama);
Â  fd.append('kelas', kelas);
Â  fd.append('sesi', sesi);
Â  for(let i=0;i<questions.length;i++){if(!fd.has('q'+i))fd.append('q'+i,'0');}

Â  const params = new URLSearchParams();
Â  fd.forEach((v, k) => params.append(k, v));
Â Â 
Â  document.getElementById('btnNext').textContent = 'Mengirim...';
Â  document.getElementById('btnNext').disabled = true;


Â  fetch(form.action, {
Â  Â  method: 'POST',
Â  Â  headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
Â  Â  body: params
Â  })
Â  .then(res => res.text())
Â  .then(txt => {
Â  Â  // --- KODE AKHIR UNTUK NOTIFIKASI ELEGAN & RESET ---
Â  Â  if (txt.includes('SUKSES_APEND_BERHASIL')) { 
Â  Â  Â  Â  completeFormReset(); // Lakukan reset sempurna
Â  Â  Â  Â  showSuccessOverlay(); // Tampilkan notifikasi elegan
Â  Â  } else {
Â  Â  Â  Â  // Tampilkan pesan error mentah dari server Google jika gagal
Â  Â  Â  Â  alert('Pengiriman GAGAL (Apps Script Error). Pesan Server: ' + txt);
Â  Â  }
Â  Â Â 
Â  Â  document.getElementById('btnNext').textContent = 'KIRIM REFLEKSI';
Â  Â  document.getElementById('btnNext').disabled = false;
Â  Â  updateNav();

Â  })
Â  .catch(err => {
Â  Â  alert('Gagal mengirim data (Gagal Koneksi). Cek koneksi internet Anda. Error: ' + err.message);
Â  Â  document.getElementById('btnNext').textContent = 'KIRIM REFLEKSI';
Â  Â  document.getElementById('btnNext').disabled = false;
Â  });
}

</script>
</body>
</html>
