<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FORM REFLEKSI SPREADSHEET</title>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> 
<style>
:root{
  --bg: #f5f8ff; 
  --accent: #007bff; 
  --muted: #334e68; 
  --card: #ffffff; 
  --input: #f7f9fc; 
  --nav-bg: #eaf1fa; 
  --shadow-light: rgba(0, 0, 0, 0.05);
  --shadow-medium: rgba(0, 0, 0, 0.1);
}
*{box-sizing:border-box; transition: all 0.2s ease-out;}
body{font-family:"Segoe UI",system-ui,Roboto,Arial,sans-serif;margin:0;background:var(--bg);color:var(--muted);font-size:13px} 

/* --- KOREKSI HEADER UNTUK IKON HOME --- */
header{
  position:fixed;
  top:0;
  left:0;
  right:0;
  background:linear-gradient(90deg, #007bff, #0056b3);
  color:#fff;
  padding:10px 8px;
  z-index:220; 
  box-shadow: 0 2px 5px var(--shadow-medium);
  display: flex; /* Aktifkan Flexbox */
  justify-content: space-between; /* Pisahkan konten */
  align-items: center;
}
header h1{
  margin:0;
  font-weight:700;
  font-size:16px;
  text-align:center;
  flex-grow: 1; /* Biarkan judul mengambil ruang tengah */
}
.home-icon-link {
    color: #fff;
    text-decoration: none;
    font-size: 18px; /* Ukuran ikon HOME */
    padding: 0 5px;
    line-height: 1;
}
.home-icon-link:hover {
    color: #ffd700; 
}
/* --- END KOREKSI HEADER --- */

.identity-bar{position:fixed;top:40px; left:0;right:0;background:var(--nav-bg);padding:8px 10px;z-index:215;border-bottom:1px solid #dcdfe4; box-shadow: 0 1px 3px var(--shadow-light);} 
.identity-inner{max-width:980px;margin:0 auto;display:flex;flex-direction:column;gap:6px} 
.identity-row{display:flex;gap:8px;flex-wrap:wrap} 
.identity-field{flex:1}
label{display:block;font-size:14px;font-weight:700;color:var(--muted);margin-bottom:2px} 
input[type="text"], select{width:100%;padding:6px 8px;border-radius:6px;border:1px solid #c9d6e4;background:var(--input);font-size:13px; color:var(--muted);} 
input[type="text"]:focus, select:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);}

.label-nama {
    font-size: 14px; 
    font-weight: 700; 
    color: var(--muted); 
}

/* --- FIXED NAVIGATION CSS --- */
.question-nav-fixed-bar {
    position: fixed;
    top: 190px; 
    left: 0;
    right: 0;
    background: #fff; 
    padding: 5px 0;
    z-index: 200; 
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid #e0e8f0;
}
.fixed-nav-inner {
    max-width: 980px;
    margin: 0 auto;
    text-align: center;
    padding: 0 10px;
    display: flex;
    flex-wrap: wrap; 
    justify-content: center;
    gap: 4px; 
}
.fixed-nav-inner button{
    display:inline-block;
    margin:0; 
    padding:4px 6px; 
    border-radius:4px;
    border:none;
    background:#d8e8ff;
    color:#0056b3;
    font-size:11px;
    cursor:pointer;
    min-width:28px; 
    font-weight: 600; 
    box-shadow: 0 1px 2px var(--shadow-light);
    flex-shrink: 0; 
}
.fixed-nav-inner button:hover { background: #c6daff; }
.fixed-nav-inner button.current-q { background: var(--accent)!important; color: #fff!important; box-shadow: 0 2px 4px rgba(0, 123, 255, 0.3);}

.main{max-width:980px;margin:0 auto;padding:250px 10px 80px;}

.question-card{background:var(--card);border-left:4px solid var(--accent);padding:10px; border-radius:8px;margin-bottom:15px; box-shadow:0 4px 8px var(--shadow-light); position: relative;}
.q-text{font-size:16px;margin:0 0 6px 0;font-weight:700;color:var(--accent);} 
.options{display:flex;flex-direction:column;gap:4px} 
.opt{display:flex;align-items:flex-start;gap:8px;padding:6px 8px; border-radius:6px;background:var(--input);border:1px solid #e0e8f0;font-size:17px; cursor: pointer; position: relative;} 
.opt:hover{background: #eaf1fa; border-color: #c9d6e4;}

.opt input[type="radio"]:checked + span {font-weight: 700;color: #0056b3;}
.opt input[type="radio"]{display: none;}
.opt.checked-option {
    background: #e8f0fe;
    border: 2px solid var(--accent);
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1); 
}
.opt span{display:block;font-weight:400;color:var(--muted);font-size:13px;line-height:1.3} 

.fixed-send{position:fixed;left:0;right:0;bottom:0;background:linear-gradient(90deg, #007bff, #0056b3);padding:8px 10px; z-index:230;box-shadow:0 -2px 8px rgba(0,0,0,0.1);}
.fixed-inner{max-width:980px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;gap:10px}
.footer-note { color: #fff; font-size: 11px; font-weight: 400; margin: 0;} 
.btn-send{background:#fff;color:var(--accent);padding:8px 12px; border-radius:6px;border:none;font-weight:700;cursor:pointer; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);}
.btn-send:hover{background:#f0f0f0; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);}
.btn-send:active{transform: translateY(1px);}

@media (max-width:480px){
  .main{padding-top:250px;padding-bottom:70px}
  .identity-bar{top:44px;}
  .question-nav-fixed-bar { top: 180px; }
  .fixed-nav-inner button{padding:3px 5px; min-width:24px; font-size:13px;}
}

/* CSS BARU UNTUK FLOATING MENU */
#floating-menu {
    position: absolute;
    top: 40px; /* Tepat di bawah header (tinggi header ~40px) */
    right: 8px; /* Sejajar dengan tombol */
    background: var(--card);
    border: 1px solid #ddd;
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    z-index: 235; 
    min-width: 180px;
    display: none;
    animation: fadeIn 0.15s ease-out;
}
#floating-menu a {
    display: block;
    padding: 8px 12px;
    color: var(--muted);
    text-decoration: none;
    font-size: 13px;
    font-weight: 600;
    white-space: nowrap;
}
#floating-menu a:hover {
    background: #f7f7f7;
    color: var(--accent);
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
}
</style>
</head>
<body>
<header>
  <a href="https://andes-web.github.io/mpsmobile/" target="_blank" class="home-icon-link" title="Beranda">
    üè†
  </a>
  
  <h1>FORM REFLEKSI SPREADSHEET</h1>
  
  <button id="menu-btn" type="button" style="background:none; border:none; color:#fff; font-size:17px; cursor:pointer; padding:0 5px;" title="Menu Lain">
    ‚ò∞
  </button>
  </header>

<div id="floating-menu">
    <a href="https://andes-web.github.io/mpsmobile/solo/asesmen.html" target="_blank">
        Asesmen Spreadsheet
    </a>
</div>
<div class="identity-bar">
  <div class="identity-inner">
    <div class="identity-row">
      <div class="identity-field">
        <label for="kelas">Kelas</label>
        <select id="kelas" name="kelas" required>
          <option value="">Pilih Kelas</option>
          <option value="KELAS X AKL1">KELAS X AKL1</option>
          <option value="KELAS X AKL2">KELAS X AKL2</option>
          <option value="KELAS X AKL3">KELAS X AKL3</option>
          <option value="KELAS X AKL4">KELAS X AKL4</option>
        </select>
      </div>
      <div class="identity-field">
        <label for="sesi">Sesi</label>
        <select id="sesi" name="sesi" required>
          <option value="">Pilih Sesi</option>
          <option value="As Learning">As Learning</option>
          <option value="For Learning">For Learning</option>
          <option value="Of Learning">Of Learning</option>
        </select>
      </div>
    </div>
    <div class="identity-field">
      <label for="nama" class="label-nama">Nama Peserta Didik</label>
      <input id="nama" name="nama" type="text" placeholder="Pilih Kelas dahulu untuk memuat daftar nama" required list="student-names">
      <datalist id="student-names"></datalist>
    </div>
  </div>
</div>

<div class="question-nav-fixed-bar">
  <div class="fixed-nav-inner" id="fixedNavButtons">
  </div>
</div>

<main class="main">
  <form id="refleksiForm" method="POST" action="https://script.google.com/macros/s/AKfycbyUb3JGhRAe0Z4nfmCOuSsXVuaonNHuKqA0EPLNdfJLQfeXowmmW18imKZoiV640Whp0Q/exec">
    <div id="questions"></div>
  </form>
</main>

<div class="fixed-send">
  <div class="fixed-inner">
    <p class="footer-note">@2025 Andes</p>
    <button id="btnNext" class="btn-send">KIRIM REFLEKSI</button>
  </div>
</div>

<script>
// DATA SISWA DIAMBIL LANGSUNG DARI GOOGLE SHEET YANG DIBERIKAN
const ALL_STUDENTS_DATA = [
  {"kelas":"KELAS X AKL1","nama":"Abel Oktafiani"},
  {"kelas":"KELAS X AKL1","nama":"Adilla Surgaloka"},
  {"kelas":"KELAS X AKL1","nama":"Adinda Risma Sari"},
  {"kelas":"KELAS X AKL1","nama":"Alika Akilah"},
  {"kelas":"KELAS X AKL1","nama":"Almira Najma Tazkia Amin"},
  {"kelas":"KELAS X AKL1","nama":"Angga Sanjaya"},
  {"kelas":"KELAS X AKL1","nama":"Aqilla Aisyah Putri"},
  {"kelas":"KELAS X AKL1","nama":"Ariska Putri"},
  {"kelas":"KELAS X AKL1","nama":"Ayub Bernaken Lumban Gaol"},
  {"kelas":"KELAS X AKL1","nama":"Chabita Keysia"},
  {"kelas":"KELAS X AKL1","nama":"Chika Inayah"},
  {"kelas":"KELAS X AKL1","nama":"Desvita Marshellena"},
  {"kelas":"KELAS X AKL1","nama":"Diandra Wardhatul Farha"},
  {"kelas":"KELAS X AKL1","nama":"Dila Putri Ferdiansyah"},
  {"kelas":"KELAS X AKL1","nama":"Dimas Abdul Khoir"},
  {"kelas":"KELAS X AKL1","nama":"Dwi Nefta Amanda Putri"},
  {"kelas":"KELAS X AKL1","nama":"Faisal Muttaqin"},
  {"kelas":"KELAS X AKL1","nama":"Febyolla Putri Hardillah"},
  {"kelas":"KELAS X AKL1","nama":"Gracia Aurora Tesalonika Yance"},
  {"kelas":"KELAS X AKL1","nama":"Hanif Assyatir"},
  {"kelas":"KELAS X AKL1","nama":"Jesika Melia Putri"},
  {"kelas":"KELAS X AKL1","nama":"Kanaya Oktaviani"},
  {"kelas":"KELAS X AKL1","nama":"Keysha Nur Syahira"},
  {"kelas":"KELAS X AKL1","nama":"Khaila Nuriyah"},
  {"kelas":"KELAS X AKL1","nama":"Miftahul Nur Alfi"},
  {"kelas":"KELAS X AKL1","nama":"Muhammad Fadli"},
  {"kelas":"KELAS X AKL1","nama":"Muhammad Fauzan"},
  {"kelas":"KELAS X AKL1","nama":"Muhammad Rozak Nur Fajar"},
  {"kelas":"KELAS X AKL1","nama":"Mustika Kirania Putri"},
  {"kelas":"KELAS X AKL1","nama":"Mutiara Kusuma Dewi"},
  {"kelas":"KELAS X AKL1","nama":"Nabila Illa Tresna"},
  {"kelas":"KELAS X AKL1","nama":"Rafka Jaya Wibowo"},
  {"kelas":"KELAS X AKL1","nama":"Raina Azalla"},
  {"kelas":"KELAS X AKL1","nama":"Ratu Bilqis Khairunisa"},
  {"kelas":"KELAS X AKL1","nama":"Riqza Maulana Hidayatulloh"},
  {"kelas":"KELAS X AKL1","nama":"Riza Putra Andrian"},
  {"kelas":"KELAS X AKL1","nama":"RizK1 Maulana Putra"},
  {"kelas":"KELAS X AKL1","nama":"RizK1 Putra Wardhana"},
  {"kelas":"KELAS X AKL1","nama":"Ri2K1 Tri Hadi Putra"},
  {"kelas":"KELAS X AKL1","nama":"Sandi Permana"},
  {"kelas":"KELAS X AKL1","nama":"Shofy Humairoh"},
  {"kelas":"KELAS X AKL1","nama":"Sigit Bagus Prayoga"},
  {"kelas":"KELAS X AKL1","nama":"Sigit Putra Ramadhan"},
  {"kelas":"KELAS X AKL1","nama":"Siti Hardianti"},
  {"kelas":"KELAS X AKL1","nama":"Syafa Syawalia"},
  {"kelas":"KELAS X AKL1","nama":"Talitha Salsabila"},
  {"kelas":"KELAS X AKL1","nama":"Wafda Nurahmah"},
  {"kelas":"KELAS X AKL1","nama":"Willjo Satriani"},
  {"kelas":"KELAS X AKL1","nama":"Yunita Nurohmawati"},
  {"kelas":"KELAS X AKL2","nama":"Aisyah Fitria"},
  {"kelas":"KELAS X AKL2","nama":"Amirah Parisya Anggraini"},
  {"kelas":"KELAS X AKL2","nama":"Anisa Dwi Febrjna"},
  {"kelas":"KELAS X AKL2","nama":"Anisah"},
  {"kelas":"KELAS X AKL2","nama":"Aqila Syahla Ramadhani"},
  {"kelas":"KELAS X AKL2","nama":"Aulia Nur Aini"},
  {"kelas":"KELAS X AKL2","nama":"Bening Makailla Hidayat"},
  {"kelas":"KELAS X AKL2","nama":"Chaesya Esa Claudia"},
  {"kelas":"KELAS X AKL2","nama":"Cikal Kirana Prasetyo"},
  {"kelas":"KELAS X AKL2","nama":"Citra Adinda"},
  {"kelas":"KELAS X AKL2","nama":"Dewi Paramitha Larasati"},
  {"kelas":"KELAS X AKL2","nama":"Dimas Wafiqia Dava"},
  {"kelas":"KELAS X AKL2","nama":"Eirine Queensa Elizabeth Kappuw"},
  {"kelas":"KELAS X AKL2","nama":"Fabiyan AzKa Anwar"},
  {"kelas":"KELAS X AKL2","nama":"Farhataini Nurfitri"},
  {"kelas":"KELAS X AKL2","nama":"Fatih Syamil"},
  {"kelas":"KELAS X AKL2","nama":"Haysya Juliana Putri"},
  {"kelas":"KELAS X AKL2","nama":"Heny Risky Aprillia"},
  {"kelas":"KELAS X AKL2","nama":"Humairah Fitri Ramadhani"},
  {"kelas":"KELAS X AKL2","nama":"Inka Putri Arvianti"},
  {"kelas":"KELAS X AKL2","nama":"Iza Azmi Athifa"},
  {"kelas":"KELAS X AKL2","nama":"Jesi Ramadini"},
  {"kelas":"KELAS X AKL2","nama":"Kanza Zahran Al Baihaqi"},
  {"kelas":"KELAS X AKL2","nama":"Khansa Kamiliya Shafa"},
  {"kelas":"KELAS X AKL2","nama":"Lubna Al-Ghiffarl"},
  {"kelas":"KELAS X AKL2","nama":"Lusi Sebriayani"},
  {"kelas":"KELAS X AKL2","nama":"Mahmud Ahmed Dinejat"},
  {"kelas":"KELAS X AKL2","nama":"Meyta Dini Haryanti"},
  {"kelas":"KELAS X AKL2","nama":"Muhamad Aditya Ramadan"},
  {"kelas":"KELAS X AKL2","nama":"Muhamad Faturahman As Sya'Bani"},
  {"kelas":"KELAS X AKL2","nama":"Muhamad Fikry Al Latief"},
  {"kelas":"KELAS X AKL2","nama":"Muhammad Hafjizhu Adzany"},
  {"kelas":"KELAS X AKL2","nama":"Nabila Husen"},
  {"kelas":"KELAS X AKL2","nama":"Nabilah Rahma"},
  {"kelas":"KELAS X AKL2","nama":"Nazwa Azqiya Ginanjar"},
  {"kelas":"KELAS X AKL2","nama":"Nazwa Maulidya"},
  {"kelas":"KELAS X AKL2","nama":"Niswatul Aziza"},
  {"kelas":"KELAS X AKL2","nama":"Nur Kayla"},
  {"kelas":"KELAS X AKL2","nama":"Putri Indah Agustina"},
  {"kelas":"KELAS X AKL2","nama":"Qotrunada Nirpataka Hibatullah"},
  {"kelas":"KELAS X AKL2","nama":"Rismawati"},
  {"kelas":"KELAS X AKL2","nama":"Safira Hayy Nurbaiti"},
  {"kelas":"KELAS X AKL2","nama":"Siti Nurul Hidayati"},
  {"kelas":"KELAS X AKL2","nama":"Suci Fitria Rahmadhani"},
  {"kelas":"KELAS X AKL2","nama":"Syakila Erdila Sari"},
  {"kelas":"KELAS X AKL2","nama":"Syifa Ghaziyah Anwar"},
  {"kelas":"KELAS X AKL2","nama":"Vera Cantika"},
  {"kelas":"KELAS X AKL2","nama":"Yeremia"},
  {"kelas":"KELAS X AKL2","nama":"Zivara Mabela Sesanti"},
  {"kelas":"KELAS X AKL3","nama":"Adilla Ramadani"},
  {"kelas":"KELAS X AKL3","nama":"Adinda Putri Nur Arief"},
  {"kelas":"KELAS X AKL3","nama":"Alisa Dwi Anggeraini"},
  {"kelas":"KELAS X AKL3","nama":"Almira Shaka Andrea"},
  {"kelas":"KELAS X AKL3","nama":"Alvina Rahma Novrianti"},
  {"kelas":"KELAS X AKL3","nama":"Alva Asyla Mukhbita"},
  {"kelas":"KELAS X AKL3","nama":"AnasyA"},
  {"kelas":"KELAS X AKL3","nama":"Asyifa Nurajni Aulia Leksono"},
  {"kelas":"KELAS X AKL3","nama":"Bima Sakti Rahmatulloh"},
  {"kelas":"KELAS X AKL3","nama":"Clariza Adya Nathaneila"},
  {"kelas":"KELAS X AKL3","nama":"Dela Maulida"},
  {"kelas":"KELAS X AKL3","nama":"Destari Aulia"},
  {"kelas":"KELAS X AKL3","nama":"Dhiha Mega Wangi Hidayat"},
  {"kelas":"KELAS X AKL3","nama":"Dhikaloka Rahma"},
  {"kelas":"KELAS X AKL3","nama":"Diana Syafitri"},
  {"kelas":"KELAS X AKL3","nama":"Dinara Anindytha Putri Pratiwi"},
  {"kelas":"KELAS X AKL3","nama":"Ervan Putra Pratama"},
  {"kelas":"KELAS X AKL3","nama":"Farisha Nur Maulida"},
  {"kelas":"KELAS X AKL3","nama":"Fathia Rizqiqa Amalia"},
  {"kelas":"KELAS X AKL3","nama":"Fayrus Chalisa Zulfa"},
  {"kelas":"KELAS X AKL3","nama":"Hana Alisa"},
  {"kelas":"KELAS X AKL3","nama":"Hilda Aryani"},
  {"kelas":"KELAS X AKL3","nama":"Indana Askia Putri"},
  {"kelas":"KELAS X AKL3","nama":"Indira Okta Vira"},
  {"kelas":"KELAS X AKL3","nama":"Iren Sakharina Sarfina Hady"},
  {"kelas":"KELAS X AKL3","nama":"Irma Suryani"},
  {"kelas":"KELAS X AKL3","nama":"Juanita"},
  {"kelas":"KELAS X AKL3","nama":"Keisha Audreylia Shafiqa"},
  {"kelas":"KELAS X AKL3","nama":"Marchello Tandian"},
  {"kelas":"KELAS X AKL3","nama":"Muhamad Saputra"},
  {"kelas":"KELAS X AKL3","nama":"Muhammad Azka Rayyan"},
  {"kelas":"KELAS X AKL3","nama":"Muhammad Havip"},
  {"kelas":"KELAS X AKL3","nama":"Muhammad Iqram Haryadi"},
  {"kelas":"KELAS X AKL3","nama":"Muhammad Rafky Alfarezi"},
  {"kelas":"KELAS X AKL3","nama":"Nadira Ayu Kusumaningtyas"},
  {"kelas":"KELAS X AKL3","nama":"Nadzwa Adelia Suherman"},
  {"kelas":"KELAS X AKL3","nama":"Nayla Asifa Syafira"},
  {"kelas":"KELAS X AKL3","nama":"Nur Nadiah"},
  {"kelas":"KELAS X AKL3","nama":"Rahelda Anaya Rasya"},
  {"kelas":"KELAS X AKL3","nama":"Ratu Erica Qurfania"},
  {"kelas":"KELAS X AKL3","nama":"Resty Audi"},
  {"kelas":"KELAS X AKL3","nama":"Rizka Nadya Fitri"},
  {"kelas":"KELAS X AKL3","nama":"Safa Asfia Almira"},
  {"kelas":"KELAS X AKL3","nama":"Salfa Ainur Rofikah"},
  {"kelas":"KELAS X AKL3","nama":"Sindi Septiani"},
  {"kelas":"KELAS X AKL3","nama":"Siti Revalina"},
  {"kelas":"KELAS X AKL3","nama":"Thalita Putri"},
  {"kelas":"KELAS X AKL3","nama":"Umroh Agustin"},
  {"kelas":"KELAS X AKL3","nama":"Zahra Yuanita Putri"},
  {"kelas":"KELAS X AKL4","nama":"Aila Junisa"},
  {"kelas":"KELAS X AKL4","nama":"Ajeng Pertiwi"},
  {"kelas":"KELAS X AKL4","nama":"Alya Putri Amanda"},
  {"kelas":"KELAS X AKL4","nama":"Anisa Putri"},
  {"kelas":"KELAS X AKL4","nama":"Arista Putri Kirana"},
  {"kelas":"KELAS X AKL4","nama":"Caturin Putri Fatimah"},
  {"kelas":"KELAS X AKL4","nama":"Dhea Kesya Novriyanti"},
  {"kelas":"KELAS X AKL4","nama":"Difa Julia Lestary"},
  {"kelas":"KELAS X AKL4","nama":"Dika Rahadea Nizar"},
  {"kelas":"KELAS X AKL4","nama":"Dinda Nuni Wulandari"},
  {"kelas":"KELAS X AKL4","nama":"Dwi Indriani"},
  {"kelas":"KELAS X AKL4","nama":"Fitri Nurkarimah"},
  {"kelas":"KELAS X AKL4","nama":"Ghina Rifqoh Chasanah"},
  {"kelas":"KELAS X AKL4","nama":"Jihan Khaerunisa"},
  {"kelas":"KELAS X AKL4","nama":"Kevin Rafif"},
  {"kelas":"KELAS X AKL4","nama":"Keyla Kanza Juliana"},
  {"kelas":"KELAS X AKL4","nama":"Keyla Siti Zahra"},
  {"kelas":"KELAS X AKL4","nama":"Khairul Ihwan"},
  {"kelas":"KELAS X AKL4","nama":"Khairunisa"},
  {"kelas":"KELAS X AKL4","nama":"Maharani Wanara"},
  {"kelas":"KELAS X AKL4","nama":"Maulana Malik Ibrahim"},
  {"kelas":"KELAS X AKL4","nama":"Meilina Wulandari"},
  {"kelas":"KELAS X AKL4","nama":"Melati Cahaya Ramadhani"},
  {"kelas":"KELAS X AKL4","nama":"Muhamad Fadly"},
  {"kelas":"KELAS X AKL4","nama":"Muhammad Delly Akbar"},
  {"kelas":"KELAS X AKL4","nama":"Muhammad Rizky Kurniawan"},
  {"kelas":"KELAS X AKL4","nama":"Naila Nur Azizah"},
  {"kelas":"KELAS X AKL4","nama":"Nindia Oktaviani Putri"},
  {"kelas":"KELAS X AKL4","nama":"Nur Kayna Adhalia"},
  {"kelas":"KELAS X AKL4","nama":"Putri Aisyah Rahman"},
  {"kelas":"KELAS X AKL4","nama":"Rafael Kenzi"},
  {"kelas":"KELAS X AKL4","nama":"Rahma Maulidya"},
  {"kelas":"KELAS X AKL4","nama":"Ratu Anzani Dwi Putri"},
  {"kelas":"KELAS X AKL4","nama":"Reyhana Putri Rahmadina"},
  {"kelas":"KELAS X AKL4","nama":"Rimba Al Musyaffa"},
  {"kelas":"KELAS X AKL4","nama":"Risma Putri Kirani"},
  {"kelas":"KELAS X AKL4","nama":"Rosmalina Wijayanti"},
  {"kelas":"KELAS X AKL4","nama":"Safa Azahra"},
  {"kelas":"KELAS X AKL4","nama":"Salwa Khoerunisa"},
  {"kelas":"KELAS X AKL4","nama":"Septiany Nur Aulia"},
  {"kelas":"KELAS X AKL4","nama":"Shelina Putri"},
  {"kelas":"KELAS X AKL4","nama":"Sherylua Puspa Westrj"},
  {"kelas":"KELAS X AKL4","nama":"Suci Aulina"},
  {"kelas":"KELAS X AKL4","nama":"Syifa Khoirunisa"},
  {"kelas":"KELAS X AKL4","nama":"Syifah Syafwah"},
  {"kelas":"KELAS X AKL4","nama":"Talita Sakhi"},
  {"kelas":"KELAS X AKL4","nama":"Tia Amelia"},
  {"kelas":"KELAS X AKL4","nama":"Zahirah Sarah Amirah"},
  {"kelas":"KELAS X AKL4","nama":"Zahra Assita"}
];

const questions = [
 "Bagaimana Anda memahami peran spreadsheet dalam pengelolaan uang jajan atau kas sekolah?",
 "Bagaimana Anda menuliskan operasi aritmatika sederhana (+, -, *, /) di spreadsheet untuk menghitung total?",
 "Bagaimana Anda memanfaatkan fungsi SUM untuk menghitung total pemasukan atau pengeluaran?",
 "Bagaimana Anda menggunakan AVERAGE untuk mengetahui rata-rata pengeluaran mingguan?",
 "Bagaimana Anda memakai COUNT dan COUNTA untuk menghitung entri angka dan teks di tabel?",
 "Bagaimana Anda menggunakan COUNTIF dan COUNTBLANK untuk memeriksa data tertentu dan sel kosong?",
 "Bagaimana Anda menerapkan SUMIF untuk menjumlahkan transaksi berdasarkan kategori tertentu?",
 "Bagaimana Anda menggunakan fungsi IF/AND/OR untuk memberi status otomatis (mis: Lunas/Tidak)?",
 "Bagaimana Anda memakai VLOOKUP atau HLOOKUP untuk mengambil data dari tabel lain?",
 "Bagaimana Anda menggabungkan beberapa fungsi agar laporan keuangan lebih otomatis dan akurat?",
 "Bagaimana Anda membaca hasil perhitungan untuk mengambil keputusan sederhana pada pengeluaran?",
 "Bagaimana Anda menggunakan spreadsheet untuk merencanakan anggaran kegiatan kecil atau proyek kelas?",
 "Bagaimana Anda mencari dan memperbaiki kesalahan rumus yang menyebabkan hasil tidak sesuai?",
 "Bagaimana Anda menilai perkembangan kemampuan spreadsheet Anda sejak awal pembelajaran?",
 "Bagaimana rencana Anda agar kemampuan spreadsheet semakin meningkat setelah fase ini?"
];

const options = [
 ["Saya belum mencoba atau memahami penggunaannya sama sekali.",
  "Saya tahu fungsi dasar spreadsheet namun belum menghubungkannya ke keuangan.",
  "Saya mampu mencatat dan menghitung transaksi sederhana dalam tabel pribadi.",
  "Saya bisa membuat tabel kas sederhana dan menjelaskan fungsinya ke teman.",
  "Saya mampu merancang format laporan kas yang rapi dan terpakai di praktik nyata."],
 ["Saya belum tahu cara menulis operasi aritmatika di sel spreadsheet.",
  "Saya pernah menulis rumus pada satu sel namun sering menghasilkan error.",
  "Saya menulis operasi aritmatika untuk beberapa perhitungan sederhana dengan benar.",
  "Saya menggabungkan beberapa operasi untuk menghitung total dan subtotal dengan benar.",
  "Saya membuat rumus aritmatika kompleks untuk otomatisasi perhitungan berulang."]
];

const qContainer=document.getElementById('questions');
let current=0;

function createQuestions(){
  for(let i=0;i<questions.length;i++){
    const card=document.createElement('div');
    card.className='question-card';
    card.id='q'+i;
    card.style.display='none';

    const q=document.createElement('p');
    q.className='q-text';
    q.textContent=(i+1)+'. '+questions[i];
    card.appendChild(q);
    
    const optWrap=document.createElement('div');
    optWrap.className='options';
    (options[i%2]).forEach((op,j)=>{
      const label=document.createElement('label');
      label.className='opt';
      const input=document.createElement('input');
      input.type='radio';input.name='q'+i;input.value=j+1;
      
      input.addEventListener('change', function() {
          label.parentElement.querySelectorAll('.opt').forEach(l => l.classList.remove('checked-option'));
          if (this.checked) {
              label.classList.add('checked-option');
          }
          updateNav();
      });
      
      const span=document.createElement('span');
      span.textContent=op;
      
      label.appendChild(input);
      label.appendChild(span);
      optWrap.appendChild(label);
    });
    card.appendChild(optWrap);

    qContainer.appendChild(card);
  }
  generateFixedNav();
}

function generateFixedNav() {
    const navContainer = document.getElementById('fixedNavButtons');
    for(let n=0; n < questions.length; n++) {
        const btn = document.createElement('button');
        btn.textContent = n + 1;
        btn.type = 'button';
        btn.onclick = () => show(n);
        navContainer.appendChild(btn);
    }
}

createQuestions();
show(0);

function show(i){
  document.querySelectorAll('.question-card').forEach(c=>c.style.display='none');
  const currentCard = document.getElementById('q'+i);
  if (currentCard) {
      currentCard.style.display='block';
      current=i;
      updateNav();
      window.scrollTo({ top: 0, behavior: 'smooth' });
  }
}

function updateNav(){
  const btns = document.getElementById('fixedNavButtons').querySelectorAll('button');
  
  btns.forEach((b,i)=>{
    const radio = document.querySelector('input[name="q'+i+'"]:checked');
    const answered=!!radio;
    
    if (i === current) {
        b.classList.add('current-q');
    } else {
        b.classList.remove('current-q');
    }

    if (answered) {
        b.style.background = 'var(--accent)';
        b.style.color = '#fff';
        if (radio && document.querySelector('label.opt input[name="q'+i+'"][value="'+radio.value+'"]')) {
            document.querySelector('label.opt input[name="q'+i+'"][value="'+radio.value+'"]').parentElement.classList.add('checked-option');
        }
    } else if (i !== current) { 
        b.style.background = '#d8e8ff';
        b.style.color = '#0056b3';
        document.querySelectorAll('label.opt input[name="q'+i+'"]').forEach(r => r.parentElement.classList.remove('checked-option'));
    }
  });
}

// LOGIKA BARU UNTUK DATALIST NAMA
document.addEventListener('DOMContentLoaded', () => {
    updateNav();
    // Langsung panggil updateNamaList() saat DOMContentLoaded
    // Data siswa sudah dimuat di ALL_STUDENTS_DATA
    
    // Tambahkan event listener untuk pilihan Kelas
    document.getElementById('kelas').addEventListener('change', updateNamaList);

    // START: LOGIKA BARU FLOATING DROPDOWN MENU
    const menuBtn = document.getElementById('menu-btn');
    const floatingMenu = document.getElementById('floating-menu');

    menuBtn.addEventListener('click', function(event) {
        event.stopPropagation(); 
        
        const isHidden = floatingMenu.style.display === 'none' || floatingMenu.style.display === '';
        floatingMenu.style.display = isHidden ? 'block' : 'none';

        if (isHidden) {
            // Pasang event listener untuk menutup menu saat klik di luar
            setTimeout(() => { 
                window.addEventListener('click', closeFloatingMenu, { once: true });
            }, 50);
        }
    });

    function closeFloatingMenu(event) {
        if (floatingMenu.contains(event.target) || event.target === menuBtn) {
            window.addEventListener('click', closeFloatingMenu, { once: true });
            return;
        }
        floatingMenu.style.display = 'none';
    }

    floatingMenu.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', () => {
            floatingMenu.style.display = 'none';
        });
    });
    // END: LOGIKA BARU FLOATING DROPDOWN MENU
});

// Fungsi untuk memfilter nama dan memperbarui datalist
function updateNamaList() {
    const selectedKelas = document.getElementById('kelas').value;
    const datalist = document.getElementById('student-names');
    const namaInput = document.getElementById('nama');

    datalist.innerHTML = ''; // Kosongkan daftar nama yang ada
    namaInput.value = ''; // Kosongkan input nama
    
    namaInput.placeholder = 'Pilih Kelas dahulu untuk memuat daftar nama';
    if(ALL_STUDENTS_DATA.length > 0) {
        namaInput.placeholder = 'Tuliskan nama lengkap Anda';
    }


    if (!selectedKelas) {
        return; 
    }
    
    // Implementasi logika pemetaan kelas yang diminta:
    // AKL1, AKL3, AKL4 -> data kelas itu sendiri
    // AKL2 -> data AKL1
    let targetKelas = selectedKelas;
    if (selectedKelas === 'KELAS X AKL2') {
        targetKelas = 'KELAS X AKL1'; 
    }

    // Filter data siswa
    const filteredStudents = ALL_STUDENTS_DATA.filter(student => 
        student.kelas === targetKelas
    );

    // Tambahkan nama ke datalist
    if (filteredStudents.length > 0) {
        filteredStudents.forEach(student => {
            const option = document.createElement('option');
            option.value = student.nama;
            datalist.appendChild(option);
        });
    } else {
         // Tambahkan opsi jika tidak ada data ditemukan
         const option = document.createElement('option');
         option.value = `Tidak ada data nama ditemukan untuk ${targetKelas}`;
         datalist.appendChild(option);
    }
}
// AKHIR LOGIKA BARU UNTUK DATALIST NAMA

// MODIFIKASI: Mengganti logika validasi tombol KIRIM REFLEKSI (btnNext.onclick) agar menggunakan SweetAlert2
document.getElementById('btnNext').onclick=()=>{
  if(current<questions.length-1){
    show(current+1);
  } else {
    let allAnswered = true;
    let firstUnansweredIndex = -1;
    for(let i=0; i<questions.length; i++) {
        if (!document.querySelector('input[name="q'+i+'"]:checked')) {
            allAnswered = false;
            firstUnansweredIndex = i;
            break;
        }
    }
    
    if (allAnswered) {
        sendData();
    } else {
        Swal.fire({
            icon: 'warning',
            title: 'Refleksi Belum Lengkap!',
            text: 'Harap jawab semua pertanyaan sebelum mengirim. Pertanyaan ' + (firstUnansweredIndex + 1) + ' belum dijawab.',
            confirmButtonColor: '#007bff'
        }).then(() => {
             show(firstUnansweredIndex);
        });
    }
  }
};

// MODIFIKASI: Mengganti fungsi sendData() dengan SweetAlert2 dan Logika Reset yang lebih baik
function sendData(){
  const nama=document.getElementById('nama').value.trim();
  const kelas=document.getElementById('kelas').value;
  const sesi=document.getElementById('sesi').value;
  const btnSend = document.getElementById('btnNext');

  if(!nama||!kelas||!sesi){
      Swal.fire({
          icon: 'warning',
          title: 'Perhatian!',
          text: 'Harap lengkapi identitas (Nama, Kelas, dan Sesi) terlebih dahulu.',
          confirmButtonColor: '#007bff'
      }).then(() => {
          document.getElementById('nama').focus(); 
      });
      return;
  }

  const form=document.getElementById('refleksiForm');
  const fd=new FormData(form);
  fd.append('nama', nama);
  fd.append('kelas', kelas);
  fd.append('sesi', sesi);
  // Tambahkan jawaban yang tidak terpilih dengan nilai '0'
  for(let i=0;i<questions.length;i++){if(!fd.has('q'+i))fd.append('q'+i,'0');}

  const params = new URLSearchParams();
  fd.forEach((v, k) => params.append(k, v));
  
  // Tampilkan loading SweetAlert2
  Swal.fire({
    title: 'Mengirim Refleksi...',
    text: 'Mohon tunggu, data sedang diproses.',
    allowOutsideClick: false,
    didOpen: () => {
      Swal.showLoading();
    }
  });

  btnSend.textContent = 'Mengirim...';
  btnSend.disabled = true;


  fetch(form.action, {
    method: 'POST',
    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
    body: params
  })
  .then(res => res.text())
  .then(txt => {
    Swal.close(); // Tutup loading
    
    // Periksa respons dari Google Apps Script (Asumsi 'SUKSES_APEND_BERHASIL' dikirim dari GAS)
    if (txt.includes('SUKSES_APEND_BERHASIL')) {
        // Notifikasi Sukses
        Swal.fire({
            icon: 'success',
            title: 'Berhasil!',
            text: 'Refleksi berhasil terkirim dan data Anda sudah terekam.',
            confirmButtonColor: '#007bff'
        }).then(() => {
            // Logika RESET FORM
            form.reset();
            document.getElementById('nama').value = ''; 
            document.getElementById('kelas').value = ''; 
            document.getElementById('sesi').value = ''; 
            // Reset tampilan radio button yang telah dicentang
            document.querySelectorAll('.opt').forEach(l => {
                l.classList.remove('checked-option');
                const radio = l.querySelector('input[type="radio"]');
                if (radio) radio.checked = false; // Memastikan radio button ter-reset
            });
            show(0); // Kembali ke pertanyaan pertama
            updateNav(); // Perbarui tampilan navigasi
            updateNamaList(); // Perbarui daftar nama (mengosongkannya)

        });
        
    } else {
        // Notifikasi Gagal Server
        Swal.fire({
            icon: 'error',
            title: 'Gagal Kirim!',
            html: 'Pengiriman data GAGAL di sisi server. Cek kembali URL Web App dan izin Anda. <br><br>Pesan Server: <b>' + txt.substring(0, 100) + '...</b>',
            confirmButtonColor: '#d33'
        });
    }
    
    btnSend.textContent = 'KIRIM REFLEKSI';
    btnSend.disabled = false;
    // updateNav() dipanggil di dalam .then() jika sukses
    if (!txt.includes('SUKSES_APEND_BERHASIL')) {
        updateNav();
    }

  })
  .catch(err => {
    Swal.close(); // Tutup loading
    // Notifikasi Gagal Koneksi
    Swal.fire({
        icon: 'error',
        title: 'Gagal Koneksi!',
        text: 'Tidak dapat mengirim data. Cek koneksi internet Anda. Rincian: ' + err.message,
        confirmButtonColor: '#d33'
    });
    
    btnSend.textContent = 'KIRIM REFLEKSI';
    btnSend.disabled = false;
    updateNav();
  });
}

</script>
</body>
</html>
